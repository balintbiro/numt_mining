method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
#visualize seqlogo diagram
seqlogo <- ggseqlogo(
sequences[rfil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions',size=20)
#visualize seqlogo diagram
seqlogo <- ggseqlogo(
sequences[rfil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')
#visualize seqlogo diagram
seqlogo <- ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')
#create filter
ofil <- seqlogo_input[,'order']=='Lagomorpha'
#visualize seqlogo diagram
seqlogo <- ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')
#visualize seqlogo diagram
ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')
#visualize seqlogo diagram
ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='prob'
)+xlab('Positions')
#visualize seqlogo diagram
ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')
#visualize seqlogo diagram
ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
#visualize seqlogo diagram
ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))+
scale_x_discrete(name ="Dose (mg)",
limits=c("2","1","0.5"))
c(1:10)
c(c(-10:0))
c(c(-10:0),c(1:10))
#visualize seqlogo diagram
ggseqlogo(
sequences[ofil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))+
scale_x_discrete()
order_seqlogo_vis('Lagomorpha')
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))+
scale_x_discrete()
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=last_plot(),
bg='white',
dpi=300
)
}
order_seqlogo_vis('Lagomorpha')
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))+
scale_y(size=30)
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=last_plot(),
bg='white',
dpi=300
)
}
order_seqlogo_vis('Lagomorpha')
order_seqlogo_vis('Carnivora')
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits',
cex=3
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits',
cex=3
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=last_plot(),
bg='white',
dpi=300
)
}
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits',
cex=3
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=last_plot(),
bg='white',
dpi=300
)
}
order_seqlogo_vis('Carnivora')
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits',
cex=32
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits',
cex=32
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=last_plot(),
bg='white',
dpi=300
)
}
order_seqlogo_vis('Carnivora')
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=last_plot(),
bg='white',
dpi=300
)
}
order_seqlogo_vis('Carnivora')
seqlogo_input
seqlogo_input['order']
unique(seqlogo_input['order'])
c(unique(seqlogo_input['order']))
lapply(
c(unique(seqlogo_input['order'])),
order_seqlogo_vis
)
lapply(
c(unique(seqlogo_input['order'])),
order_seqlogo_vis
)
sapply(
c(unique(seqlogo_input['order'])),
order_seqlogo_vis
)
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
device='png',
plot=last_plot(),
bg='white',
dpi=300
)
}
order_seqlogo_vis('Carnivora')
sapply(
c(unique(seqlogo_input['order'])),
order_seqlogo_vis
)
lapply(
c(unique(seqlogo_input['order'])),
order_seqlogo_vis
)
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
device='png',
plot=seqlogo,
bg='white',
dpi=300
)
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
device='png',
plot=seqlogo,
bg='white',
dpi=300
)
}
order_seqlogo_vis('Carnivora')
order_seqlogo_vis('Carnivora')
lapply(
c(unique(seqlogo_input['order'])),
order_seqlogo_vis
)
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=seqlogo,
bg='white',
dpi=300
)
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=seqlogo,
bg='white',
dpi=300
)
}
order_seqlogo_vis('Carnivora')
lapply(
c(unique(seqlogo_input['order'])),
order_seqlogo_vis
)
order_seqlogo_vis('Lagomorpha')
order_seqlogo_vis('Rodentia')
c(unique(seqlogo_input['order']))
c(unique(seqlogo_input['order'])).dropna
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
f('../../results/seqlogos/%s.png',order),
plot=seqlogo,
bg='white',
dpi=300
)
}
order_seqlogo_vis('Chiroptera')
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=seqlogo,
bg='white',
dpi=300
)
#function for visualizing
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
plot=seqlogo,
bg='white',
dpi=300
)
}
order_seqlogo_vis('Chiroptera')
for (order in c(unique(seqlogo_input['order']))){
order_seqlogo_vis(order)
}
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
#function for visualizing
order_seqlogo_vis <- function(order){
fil <- seqlogo_input[,'order']==order
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',order),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
}
order_seqlogo_vis('Chiroptera')
for (order in c(unique(seqlogo_input['order']))){
order_seqlogo_vis(order)
}
c(unique(seqlogo_input['order'])))
c(unique(seqlogo_input['order']))
order_seqlogo_vis('Pilosa')
order_seqlogo_vis('Dermoptera')
order_seqlogo_vis('Tubulidentata')
order_seqlogo_vis('Primates')
order_seqlogo_vis('Eulipotyphla')
order_seqlogo_vis('Didelphimorphia')
order_seqlogo_vis('Diprotodontia')
order_seqlogo_vis('Chiroptera')
order_seqlogo_vis('Cingulata')
order_seqlogo_vis('Proboscidea')
order_seqlogo_vis('Dasyuromorphia')
order_seqlogo_vis('Microbiotheria')
order_seqlogo_vis('Pholidota')
order_seqlogo_vis('Artiodactyla')
order_seqlogo_vis('Macroscelidea')
order_seqlogo_vis('Perissodactyla')
order_seqlogo_vis('Monotremata')
repeat_seqlogo_vis <- function(repeatclass){
fil <- seqlogo_input[,'u_1st_repeatclass']==repeatclass
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',repeatclass),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
}
repeat_seqlogo_vis('Simple_repeat')
repeat_seqlogo_vis('Low_complexity')
repeat_seqlogo_vis('SINE/Mir')
repeat_seqlogo_vis('SINE/MIR')
repeat_seqlogo_vis('LINE/L2')
repeat_seqlogo_vis('LINE/L1')
repeat_seqlogo_vis('LTR/ERVL')
repeat_seqlogo_vis <- function(repeatclass){
fil <- seqlogo_input[,'u_1st_repeatclass']==repeatclass
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf(r'../../results/seqlogos/%s.png',repeatclass),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
}
repeat_seqlogo_vis('LTR/ERVL')
repeat_seqlogo_vis('LTR/ERVL')
repeatclass <- 'SINE/MIR'
str_replace(repeatclass)
gsub('/','_',repeatclass)
ggsave(
sprintf(r'../../results/seqlogos/%s.png',gsub('/','_',repeatclass)),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
repeat_seqlogo_vis <- function(repeatclass){
fil <- seqlogo_input[,'u_1st_repeatclass']==repeatclass
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf(r'../../results/seqlogos/%s.png',gsub('/','_',repeatclass)),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
}
repeat_seqlogo_vis('LTR/ERVL')
repeat_seqlogo_vis <- function(repeatclass){
fil <- seqlogo_input[,'u_1st_repeatclass']==repeatclass
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf(r'../../results/seqlogos/%s.png',gsub('/','_',repeatclass)),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
}
repeat_seqlogo_vis <- function(repeatclass){
fil <- seqlogo_input[,'u_1st_repeatclass']==repeatclass
seqlogo <- ggseqlogo(
sequences[fil,]$seq,
seq_type='dna',
method='bits'
)+xlab('Positions')+
theme(axis.title.x=element_text(size=30),
axis.title.y=element_text(size=30))
ggsave(
sprintf('../../results/seqlogos/%s.png',gsub('/','_',repeatclass)),
device=NULL,
plot=seqlogo,
bg='white',
dpi=300
)
}
repeat_seqlogo_vis('LTR/ERVL')
repeat_seqlogo_vis('SINE/MIR')
repeat_seqlogo_vis('LINE/L2')
repeat_seqlogo_vis('LTR/ERVL')
repeat_seqlogo_vis('DNA/hAT-Charlie')
repeat_seqlogo_vis('LTR/ERV1')
repeat_seqlogo_vis('tRNA')
repeat_seqlogo_vis('LTR/ERVL-MaLR')
repeat_seqlogo_vis('SINE/Alu')
repeat_seqlogo_vis('SINE/B4')

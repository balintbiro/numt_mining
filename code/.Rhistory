}
gos <- sapply(mice_strains,ensembl_query)
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,genomic_regions))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos['mmusculus']
gos[,'mmusculus']
typeof(gos[,'mmusculus'])
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,unlist(genomic_regions)))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos[,'mmusculus']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(ensembl)
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos[,'mmusculus']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos['mmusculus']
length(gos)
typeof(gos)
typeof(gos['mmusculus'])
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(as.data.frame(list(ensembl)))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos['mmusculus']
gos[,'mmusculus']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos['mmusculus']
typeof(gos['mmusculus'])
as.data.frame(gos['mmusculus'])
proba <- as.data.frame(gos['mmusculus'])
proba
head(proba,n=10)
typeof(proba)
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,genomic_regions))
}
gos <- sapply(mice_strains,ensembl_query)
gos[,'mmusculus']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
append(genomic_regions,ensembl)
return(ensembl)
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos[,'mmusculus']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
ensembl <- append(genomic_regions,ensembl)
return(ensembl)
}
gos <- sapply(mice_strains,ensembl_query)
gos
length(gos)
gos['mmusculus']
gos['mmusculus']['external_gene_name']
gos$mmusculus['external_gene_name']
typeof(gos$mmusculus['external_gene_name'])
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
ensembl <- append(as.list(genomic_regions),ensembl)
return(ensembl)
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos$mmusculus
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
ensembl <- append(unlist(genomic_regions),ensembl)
return(ensembl)
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos$mmusculus
gos$mmusculus['external_gene_name']
gos$mmusculus['genomic_regions']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl))
}
gos <- sapply(mice_strains,ensembl_query)
gos
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl),)
}
gos <- sapply(mice_strains,ensembl_query)
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,))
}
gos <- sapply(mice_strains,ensembl_query)
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,''))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos[1,'mmusculus']
gos
gos[2,'mmusculus']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,chromosomal_regions))
}
gos <- sapply(mice_strains,ensembl_query)
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,genomic_regions))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos[1,'mmusculus']
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(list(ensembl,unlist(genomic_regions)))
}
gos <- sapply(mice_strains,ensembl_query)
gos
gos[,'mmusculus']
gos[,'mmusculus'][2]
gos[,'mmusculus'][1]
ensembl_query <- function(mice_strain){
genomic_regions<-scan(
sprintf
(
'/Volumes/motilin/balint/numt/mice_strains_numt/genomic_regions/%s_gene_ensembl.txt',
mice_strain
),character())
not_strains <- c('mmusculus','mspretus')
if(mice_strain %in% not_strains){
ensembl_db<-useEnsembl(biomart='genes',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}else{
ensembl_db<-useEnsembl(biomart='mouse_strains',
dataset=sprintf('%s_gene_ensembl',mice_strain),
mirror='uswest')
}
ensembl<-getBM(attributes=c('external_gene_name','goslim_goa_description','name_1006'),
filters=c('chromosomal_region'),
values=genomic_regions,
mart=ensembl_db)
return(ensembl)
}
gos <- sapply(mice_strains,ensembl_query)
